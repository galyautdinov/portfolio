# XmlReportProcessor

Проект для обработки XML-отчетов с графическим интерфейсом, реализованный в рамках тестового задания.

# Описание

Приложение предназначено для преобразования XML-файлов данных в структурированный формат Employees.xml с последующей обработкой и визуализацией данных. Поддерживает два формата входных данных и предоставляет графический интерфейс для работы.


# Обязательные требования:

1. Написано XSLT-преобразование для генерации Employees.xml из Data1.xml или Data2.xml
2. Реализована программа на C#, которая:
   - Запускает XSLT-преобразование
   - Дописывает в элемент Employee атрибут с суммой всех amount/@salary
   - Дописывает в элемент Pay атрибут с суммой всех amount (для Data1.xml)
   - Имеет GUI с кнопкой запуска и отображением списка Employee с суммами выплат по месяцам

# Дополнительные требования:

3. Реализовано добавление новых данных в Data1.xml с возможностью пересчета
4. Поддержка обновления существующих записей (вместо создания дубликатов)
5. Поддержка всех месяцев года (январь-декабрь)

# Технологический стек

- **.NET 8.0** - платформа разработки
- **WinForms** - графический интерфейс
- **XML/XSLT/XPath** - обработка данных
- **C#** - язык программирования


# Входные форматы:

**Data1.xml**:
```xml
<Pay>
  <item name="Lena" surname="Ivanova" amount="1001.1" mount="march"/>
  <item name="Lena" surname="Ivanova" amount="2001" mount="january"/>
</Pay>
```

**Data2.xml**:
```xml
<Pay>
  <january>
    <item name="Lena" surname="Ivanova" amount="2001" mount="january"/>
  </january>
  <february>
    <item name="Lena" surname="Ivanova" amount="3001,10" mount="january"/>
  </february>
</Pay>
```

# Выходной формат:

**Employees.xml**:
```xml
<Employees>
  <Employee name="Lena" surname="Ivanova" total-salary="6003.20">
    <salary amount="2001" mount="january"/>
    <salary amount="3001.10" mount="february"/>
    <salary amount="1001.1" mount="march"/>
  </Employee>
</Employees>
```

# Требования к системе

- **.NET 8.0 SDK или новее**
- **Windows ОС (для поддержки WinForms)**
- **Visual Studio 2022 или Visual Studio Code (рекомендуется)**

# Установка и запуск

1. Клонирование репозитория
git clone https://github.com/galyautdinov/portfolio.git
cd portfolio/XmlReportProcessor/Source
2. Сборка проекта
dotnet restore
dotnet build
3. Запуск приложения
dotnet run

# Использование приложения

**Основные функции:**
1. Выбор файла данных - используйте выпадающий список для выбора между Data1.xml и Data2.xml
2. Обработка данных - нажмите кнопку "Process Data" для:
	- XSLT-преобразования в формат Employees.xml
	- Расчета суммарных зарплат по сотрудникам
	- Расчета общей суммы выплат (для Data1.xml)
3. Просмотр результатов - данные отображаются в таблице с разбивкой по месяцам

**Добавление данных:**
1. Нажмите кнопку "Add Data"
2. Заполните форму:
	- Имя и фамилия сотрудника
	- Сумма выплаты
	- Месяц (все 12 месяцев доступны)
3. При добавлении записи для существующего сотрудника и месяца данные автоматически обновляются

# Особенности реализации

**XSLT-преобразование:**
- Использует Muenchian grouping для группировки по сотрудникам
- Работает с обоими форматами входных данных
- Сохраняет порядок месяцев и сотрудников

**Обработка данных:**
- Корректная обработка чисел с разными разделителями
- Расчет суммарных значений с точностью до 2 decimal places
- Валидация входных данных
